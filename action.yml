name: cm-action
description: Simple action to trigger a new CM build
author: Mohammed Babelly  
inputs:
  cm-token:
    description: 'CM token'
    required: true
  app-id:
    description: 'CM app Id'
    required: true
  workflow-id:
    description: 'CM workflow Id'
    required: true   
  branch:
    description: 'Branch'
    required: true       
    default: 'master'
# outputs:
#   random-number:
#     description: "Random number"
#     value: ${{ steps.random-number-generator.outputs.random-number }}
runs:
  using: "composite"
  steps:
    - run: echo BuildId ${{ inputs.app-id }}.
      shell: bash
#     - id: random-number-generator
#       run: echo "random-number=$(echo $RANDOM)" >> $GITHUB_OUTPUT
    - id: build-cm-build
      run: |
        curl -H "Content-Type: application/json" -H "x-auth-token: ${{ inputs.cm-token }}" --data '{ "appId": "${{ inputs.app-id }}", "workflowId": "${{ inputs.workflow-id }}", "branch": "${{ inputs.branch }}"}' https://api.codemagic.io/builds
      shell: bash
#     - run: echo "${{ github.action_path }}" >> $GITHUB_PATH
#       shell: bash
#     - run: goodbye.sh
#       shell: bash
